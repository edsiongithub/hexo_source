---
layout: post
title: Ubuntu上MySql安装配置笔记
date: 2021-04-22 09:42:27
tags:  
  - mysql
---

### Environment
* Ubuntu 18.04 LTS
* Mysql 5.7

### Install
``` bash
sudo apt-get install mysql-server-5.7
```

<!--more-->
### Config
```  bash
sudo service mysql start 	#启动服务
sudo service mysql stop		#停止服务
sudo service mysql restart	#重启服务
```

1. 进入MySQL目录，打开debian.cnf文件，找到默认用户和密码，使用该用户名密码进入
``` bash
cd /etc/mysql
sudo vim debian.cnf
```
``` bash
sudo mysql -udebian-sys-maint -pXXXXXXXXXXX		
```
注意：-u和-p后面直接跟用户名密码参数值，不需要加空格
2. 成功进入后，执行一下mysql命令修改root账号密码

 ``` mysql
 show databases;
 use mysql;
 update user set authentication_string=PASSWORD("XXXX") where user='root'
 update user set plugin="mysql_native_password";
 flush privleges;
 exit;
 ```
3. 重启MySQL服务，再用root账号登录即可
``` bash
mysql -uroot -pXXXXXX 
```
4. 修改server和database的编码为utf-8
``` bash
cd /etc/mysql/mysql.conf.d
sudo vim mysqld.cnf
```
插入[mysql]节，内容如下，并在[mysqld]节下增加两行

 ``` bash
 [mysql]
 default-character-set=utf8
 ```
 ``` bash
 [mysqld]
 character_set_server=utf8
 collation_server=utf8_general_ci
 ```

5. 配置MySQL允许远程访问（默认只监听127.0.0.1的请求）。
在步骤4中的文件中，找到bind-address 设置，修改如下
``` bash
bind-address = 0.0.0.0
```
进入mysql，修改设置用户允许远程连接。（允许任意IP地址使用root账号及xxx密码访问该MySQL服务）
``` mysql
grant all privileges on *.* to 'root'@'%' identified by 'xxxx';
flush privileges;
```

 安装配置完成，可以使用mysql客户端（navicate）远程链接MySQL服务器。

6. 修改mysql登录密码，可以直接进入mysql数据库，找到user表，针对相应的host进行修改
``` mysql
use mysql;
update user set password=password("newpwd") where user="root";
flush privileges; --刷新权限（必要）
```


7. mysql 卸载
```
dpkg --list | grep mysql  --检查mysql依赖

sudo apt-get remove mysql-common
sudo apt-get autoremove mysql-server-8.0
```